CC = @CC@
CFLAGS = @CFLAGS@
CPPFLAGS = @CPPFLAGS@
BASE_DEPENDENCIES_CFLAGS = @BASE_DEPENDENCIES_CFLAGS@
MCS=mcs

SCRIPTS = \
	gapi.pl \
	gapi_pp.pl \
	gapi-parser \
	gapi2xml.pl

MODULES=GAPI/Metadata.pm

all: $(SCRIPTS) $(MODULES) gapi_format_xml gapi-fixup.exe

gapi_format_xml: formatXml.c
	$(CC) $(CPPFLAGS) -o gapi_format_xml formatXml.c `pkg-config --cflags --libs libxml-2.0 glib-2.0` $(CFLAGS) $(BASE_DEPENDENCIES_CFLAGS)

gapi-fixup.exe: gapi-fixup.cs
	$(MCS) gapi-fixup.cs

clean:
	rm -f gapi_format_xml
	rm -f gapi-fixup.exe

distclean:
	rm -f Makefile gapi_format_xml
	rm -f gapi.pc

prefix=@prefix@
DESTDIR=

install: all
	for i in $(SCRIPTS) gapi_format_xml gapi-fixup.exe; do \
		../mkinstalldirs $(DESTDIR)$(prefix)/bin && \
		cp $$i $(DESTDIR)$(prefix)/bin; \
	done
	for i in $(MODULES); do \
		../mkinstalldirs $(DESTDIR)$(prefix)/share/perl5/GAPI && \
		cp $$i $(DESTDIR)$(prefix)/share/perl5/GAPI; \
	done
	../mkinstalldirs $(DESTDIR)$(prefix)/lib/pkgconfig && \
	cp gapi.pc $(DESTDIR)$(prefix)/lib/pkgconfig
