INCLUDE_APIS = \
	../api/atk-api.xml \
	../api/pango-api.xml \
	../api/gdk-api.xml \
	../api/gdk-symbols.xml \
	../api/gtk-symbols.xml \
	../api/gtk-api.xml \
	../api/gnome-api.xml

RUNTIME=mono 

all: gtkhtml-sharp.dll

generated-stamp: gtkhtml-api.xml *.custom ../generator/gapi_codegen.exe
	$(RUNTIME) ../generator/gapi_codegen.exe --generate gtkhtml-api.xml --include $(INCLUDE_APIS) --outdir=generated --customdir=. --assembly-name=gtkhtml-sharp && touch generated-stamp

gtkhtml-sharp.dll: generated-stamp
	 $(MCS) --unsafe -nowarn:0660,0661 --target library -L ../glib -L ../pango -L ../atk -L ../gdk -L ../gtk -L ../gnome -r glib-sharp.dll -r pango-sharp.dll -r atk-sharp.dll -r gdk-sharp.dll -r gtk-sharp.dll -r gnome-sharp.dll -o gtkhtml-sharp.dll --recurse '*.cs'

clean:
	rm -f generated-stamp
	rm -f gtkhtml-sharp.dll
	rm -rf generated

prefix=@prefix@
DESTDIR=
apidir=$(DESTDIR)$(prefix)/share/gapi
libdir=$(DESTDIR)$(prefix)/lib

install: all
	../mkinstalldirs $(apidir) && \
	cp gtkhtml-api.xml $(apidir) && \
	cp gtkhtml-sharp.dll $(libdir)
